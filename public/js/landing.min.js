"use strict";
var MollyLanding = {
        NUM_NUMS: 8,
        CHANCE_PRICE_UP: .85,
        MIN_PRICE: .5,
        MAX_PRICE: 2.5,
        CONTACT_ERRORS: {},
        init: function() {
            MollyLanding.nav = document.querySelector("nav"), MollyLanding.login = document.querySelector("#login-nav"), MollyLanding.login.href = window.location.origin.replace(".cn", ".com") + "" + (-1 != window.location.href.indexOf(".cn") ? "?lang=zh-hans" : ""), window.onresize = MollyLanding.onResize, MollyLanding.onResize(), window.addEventListener("scroll", MollyLanding.onScroll), qs("a").filter(function(e) {
                return 0 !== e.href.indexOf("#")
            }).forEach(function(e) {
                return e.parentNode.addEventListener("click", function(n) {
                    var t = e.href.split("#").pop(),
                        o = document.getElementById(t);
                    o && (n.preventDefault(), n.stopPropagation(), MollyLanding.slowScrollToElement(o), ga("send", "event", "landing", "nav-click", t))
                })
            });
            var e = document.querySelector('#api a[href="#contact"]');
            e.addEventListener("click", function(n) {
                var t = e.getAttribute("data-message");
                document.querySelector("[name=how]").innerHTML = t + ". I heard about you from _______"
            }), qs(".modal").forEach(function(e) {
                var n = function() {
                    document.body.className = document.body.className.replace("modal-open", ""), e.className += " hidden"
                };
                document.body.addEventListener("keydown", function(t) {
                    27 === t.keyCode && -1 === e.className.indexOf("hidden") && n()
                }), e.addEventListener("click", function(t) {
                    t.target === e && n()
                })
            }), MollyLanding.setupCarousel();
            for (var n = 0; n < MollyLanding.NUM_NUMS; n++) {
                var t = document.createElement("div");
                t.className = "num", MollyLanding.doAnimateNum(t)
            }
            document.querySelector("#contact input[type=submit]").addEventListener("click", function(e) {
                e.preventDefault(), e.stopPropagation(), MollyLanding.displayCaptcha()
            })
        },
        getScrollTop: function() {
            return window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0
        },
        captchaLoaded: !0,
        onResize: function(e) {
            MollyLanding.NAV_SOLID_THRESHOLD = document.querySelector("h1").getBoundingClientRect().top + MollyLanding.getScrollTop() - 90, MollyLanding.navStyle(), MollyLanding.sectionOffsets = qs("section").slice(1).map(function(e) {
                return [e.offsetTop, e]
            })
        },
        sectionOffsets: [],
        activeSection: null,
        stopAnimateAbout: !1,
        onScroll: function(e) {
            MollyLanding.navStyle(), MollyLanding.highlightActiveSection(), !MollyLanding.stopAnimateAbout && MollyLanding.getScrollTop() > 400 && (MollyLanding.animateAbout(), MollyLanding.stopAnimateAbout = !0)
        },
        slowScrollToElement: function(e) {
            var n = function(e) {
                    return 1 - Math.pow((Math.sin((e + .5) * Math.PI) + 1) / 2, 2)
                },
                t = Math.sqrt(1e3),
                o = !1,
                a = MollyLanding.nav.offsetHeight,
                l = MollyLanding.getScrollTop(),
                i = Math.min(e.offsetTop - a, document.body.scrollHeight - window.innerHeight),
                r = i - l,
                c = Math.sqrt(Math.abs(r)) / (t / 1e3),
                u = new Date,
                d = function e() {
                    o = !0, window.removeEventListener("mousewheel", e)
                };
            window.addEventListener("mousewheel", d),
                function e() {
                    if (!o) {
                        var t = new Date,
                            a = (t - u) / c;
                        a < 1 ? (window.scrollTo(0, Math.floor(n(a) * r) + l), requestAnimationFrame(e)) : (window.scrollTo(0, i), MollyLanding.onScroll())
                    }
                }()
        },
        highlightActiveSection: function() {
            var e = 0,
                n = MollyLanding.sectionOffsets.length,
                t = null,
                o = MollyLanding.nav.offsetHeight;
            for (e = 0; e < n && MollyLanding.getScrollTop() + o + 100 >= MollyLanding.sectionOffsets[e][0]; e++) t = MollyLanding.sectionOffsets[e][1];
            if (t && t !== MollyLanding.activeSection) {
                MollyLanding.activeSection = t, qs("nav li.active").forEach(function(e) {
                    return e.className = ""
                });
                var a = document.querySelector("nav li a[href='#" + t.id + "']");
                if (!a) return;
                a.parentNode.className = "active"
            } else t || (MollyLanding.activeSection = null, qs("nav li.active").forEach(function(e) {
                return e.className = ""
            }))
        },
        animateAbout: function() {
            return innerWidth > 680 ? MollyLanding.animateAboutDesktop() : MollyLanding.animateAboutMobile()
        },
        animateAboutDesktop: function() {
            var e = qs("#about ul li"),
                n = e.length,
                t = 0,
                o = void 0,
                a = void 0,
                l = function n(t) {
                    e.forEach(function(e) {
                        return e.removeEventListener("mouseover", n)
                    }), a && (clearTimeout(a), a = null), o && (o.className = "")
                };
            e.forEach(function(e) {
                return e.addEventListener("mouseover", l)
            });
            var i = function() {
                return 1e3 * Math.max(qs(".carousel ul li .blurb")[t].innerText.split(" ").length / 3, 3)
            };
            ! function l() {
                o && (o.className = ""), o = e[t], o.className = "hover", a = setTimeout(l, i()), t = t + 1 >= n ? 0 : t + 1
            }()
        },
        animateAboutMobile: function() {
            var e = void 0,
                n = function n(t) {
                    document.querySelector(".carousel-btn.prev").removeEventListener("click", n), document.querySelector(".carousel-btn.next").removeEventListener("click", n), e && (clearTimeout(e), e = null)
                };
            document.querySelector(".carousel-btn.prev").addEventListener("click", n), document.querySelector(".carousel-btn.next").addEventListener("click", n);
            var t = function() {
                    return 1e3 * Math.max(qs(".carousel ul li .blurb")[MollyLanding.carouselPosition].innerText.split(" ").length / 3, 3)
                },
                o = function n() {
                    MollyLanding.moveCarousel(1), t(), e = setTimeout(n, t())
                };
            e = setTimeout(o, t())
        },
        navStyle: function() {
            MollyLanding.nav.className = MollyLanding.getScrollTop() > MollyLanding.NAV_SOLID_THRESHOLD ? "solid" : ""
        },
        setupCarousel: function() {
            document.querySelector(".carousel-btn.prev").addEventListener("click", function(e) {
                return MollyLanding.moveCarousel(-1)
            }), document.querySelector(".carousel-btn.next").addEventListener("click", function(e) {
                return MollyLanding.moveCarousel(1)
            }), MollyLanding.numCarouselItems = qs(".carousel ul li").length, MollyLanding.moveCarousel(0)
        },
        carouselPosition: 0,
        numCarouselItems: 0,
        moveCarousel: function(e) {
            var n = MollyLanding.carouselPosition + e;
            MollyLanding.carouselPosition = Math.min(Math.max(0, n), MollyLanding.numCarouselItems - 1), document.querySelector(".carousel ul").style[TRANSFORM_PROPERTY] = "translate3d(" + -100 * MollyLanding.carouselPosition + "%,0,0)"
        },
        doAnimateNum: function(e) {
            var n = document.getElementById("numbers"),
                t = void 0,
                o = void 0,
                a = void 0,
                l = void 0,
                i = void 0,
                r = void 0,
                c = void 0,
                u = void 0,
                d = function() {
                    t = (Math.random() * (MollyLanding.MAX_PRICE - MollyLanding.MIN_PRICE) + MollyLanding.MIN_PRICE).toFixed(2), o = Math.random() > .5 ? "white" : "yellow", a = Math.random() > MollyLanding.CHANCE_PRICE_UP;
                    var n = e.offsetWidth,
                        d = e.offsetHeight;
                    d = d || 70, n = n || 200;
                    var s = document.querySelector("header h1").getBoundingClientRect(),
                        m = s.top + MollyLanding.getScrollTop() - d,
                        y = s.left - n,
                        f = s.height + d + document.querySelector(" header h2").offsetHeight,
                        g = s.width + n;
                    l = Math.random() * (window.innerWidth - n), i = Math.random() * (window.innerHeight - d - 200) + 100;
                    for (var M = 0; i > m && i < m + f && l > y && l < y + g && M < 5;) l = Math.random() * (window.innerWidth - n), i = Math.random() * (window.innerHeight - d - 100) + 100, M += 1;
                    r = Math.random() * (innerWidth < 750 ? 1.5 : 3) + .5, e.style.color = o, e.innerHTML = t, e.style.opacity = 0, e.style.top = i + "px", e.style.left = l + "px", e.style.webkitFilter = e.style.filter = "blur(" + r.toFixed(2) + "px)", e.className = a ? "num down" : "num", c = 1e3 * (2 + 4 * Math.random()), u = (new Date).getTime()
                };
            d(), n.appendChild(e);
            var s = function n() {
                if (MollyLanding.getScrollTop() > 1e3) return void window.requestAnimationFrame(n);
                var t = (new Date).getTime(),
                    o = (t - u) / c;
                e.style.opacity = (.3 * (1 - o)).toFixed(2), o > 1 ? (d(), setTimeout(n, 1e3 * Math.random())) : window.requestAnimationFrame(n)
            };
            setTimeout(s, 3e3 * Math.random())
        },
        postRequest: function(e, n, t) {
            var o = JSON.stringify(n),
                a = new XMLHttpRequest;
            a.onload = function() {
                if (200 === a.status) try {
                    var e = JSON.parse(a.responseText);
                    e.status && "ok" === e.status ? t(null, e) : t(e.error || e.code)
                } catch (e) {
                    t("Server Error")
                } else t("Server Error (" + a.status + ")")
            }, a.open("POST", e), a.setRequestHeader("Content-Type", "application/json"), a.send(o)
        },
        displayCaptcha: function() {
            document.querySelector("#captcha-container").innerHTML = "", document.querySelector("#contact input[type=submit]").style.display = "none";
            try {
                grecaptcha.render("captcha-container", {
                    sitekey: "6Lc9m0MUAAAAAJCiQuGiHa72li_lPgyN-N9NVFnH",
                    callback: MollyLanding.sendMollyContactEmail
                })
            } catch (e) {
                grecaptcha.reset()
            }
        },
        sendMollyContactEmail: function(e) {
            var n = MollyLanding.gatherContactInfo();
            n.captcha_response = e, document.querySelector("#contact input[type=submit]").style.display = "none", MollyLanding.postRequest("/contact_mollybet/", n, function(e, n) {
                e ? MollyLanding.displayContactError(e) : MollyLanding.displayContactSuccess()
            })
        },
        displayContactError: function(e) {
            MollyLanding.CONTACT_ERRORS[e] && (e = MollyLanding.CONTACT_ERRORS[e]), document.querySelector("#contact-error").className = "", document.querySelector("#contact-error").innerHTML = e, document.querySelector("#contact input[type=submit]").style.display = "", document.querySelector("#captcha-container").innerHTML = ""
        },
        hideContactError: function() {
            document.querySelector("#contact-error").className = "no-error", document.querySelector("#contact-error").innerHTML = ""
        },
        displayContactSuccess: function() {
            MollyLanding.hideContactError(), document.querySelector("#contact-success").className = "", document.querySelector("#contact form").style.display = "none"
        },
        gatherContactInfo: function() {
            return {
                name: document.querySelector("[name=name]").value.trim(),
                email: document.querySelector("[name=email]").value.trim(),
                how: document.querySelector("[name=how]").innerText.trim(),
                already: document.querySelector("[name=already]").value,
                bookies: document.querySelector("[name=bookies]").innerText.trim(),
                turnover: document.querySelector("[name=turnover]").value,
                language: document.querySelector("[name=language]").value
            }
        }
    },
    qs = function(e) {
        return Array.prototype.slice.call(document.querySelectorAll(e), 0)
    },
    TRANSFORM_PROPERTY = function() {
        for (var e = document.createElement("div"), n = ["transform", "WebkitTransform", "msTransform", "MozTransform", "OTransform"], t = void 0; t = n.shift();)
            if (void 0 !== e.style[t]) return t;
        return !1
    }();
window.addEventListener("DOMContentLoaded", function(e) {
    MollyLanding.init()
});
var captchaLoaded = function() {
    return MollyLanding.captchaLoaded = !0
};
//# sourceMappingURL=landing.min.js.map